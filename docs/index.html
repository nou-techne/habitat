<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Habitat — Composable coordination infrastructure</title>
  <link rel="stylesheet" href="style.css">
  <meta property="og:title" content="Habitat — Composable coordination infrastructure">
  <meta property="og:description" content="Composable coordination infrastructure for organizations that enrich their ecosystems. Patronage accounting, composable tools, and service credits.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://the-habitat.org/">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Habitat — Composable coordination infrastructure">
  <meta name="twitter:description" content="Composable coordination infrastructure for organizations that enrich their ecosystems.">
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
  <nav>
    <a href="/" class="logo">Habitat</a>
    <div class="links">
      <a href="/" class="active">Home</a>
      <a href="/matrix/">Matrix</a>
      <a href="/patronage/">Patronage</a>
      <a href="/identity/">Identity</a>
      <a href="/thesis/">Thesis</a>
      <a href="/journal/">Journal</a>
      <a href="/agents/">Agents</a>
      <a href="/dashboard/">Dashboard</a>
    </div>
  </nav>

  <div class="hero">
    <h1>Habitat</h1>
    <p class="subtitle">Composable coordination infrastructure for organizations that enrich their ecosystems.</p>
  </div>

  <hr class="divider">

  <div class="section">
    <h2><i data-lucide="eye-off" class="section-icon icon-orange"></i> The Problem</h2>
    <p>Organizations can't see their own economic relationships. The accounting tools they rely on were built to track extraction — revenue captured, costs minimized, value concentrated. For any organization trying to do something different — a cooperative, a land trust, a mutual aid network — the tools available were designed for a different game entirely.</p>
    <p class="muted">When your tools can only measure extraction, extraction is all you can manage.</p>
  </div>

  <hr class="divider">

  <div class="section">
    <h2><i data-lucide="eye" class="section-icon icon-orange"></i> The Insight</h2>
    <p>Tools shape what you can see. What you can see determines whether you extract or enrich.</p>
    <p>An organization that wants to distribute governance, track contributions fairly, and strengthen the ecosystem it operates within needs tools built for that purpose. Not a spreadsheet adapted from corporate finance. Not a DAO dashboard with no legal standing. Infrastructure designed from the ground up for organizations that care about <em>how</em> value flows, not just <em>how much</em>.</p>
  </div>

  <hr class="divider">

  <div class="section">
    <h2><i data-lucide="layers" class="section-icon"></i> What is Habitat</h2>
    <p>Three concentric layers of coordination infrastructure, each building on the one inside it:</p>

    <div class="layer">
      <div class="layer-icon"><i data-lucide="scale"></i></div>
      <div class="layer-content">
        <h3>Patronage Accounting</h3>
        <p>Capital accounts, contribution tracking, and allocation calculations that satisfy IRC Section 704(b) compliance. The legal heartbeat of a cooperative — who contributed what, and how does value flow back? Built to the most rigorous standard first, so simpler organizations use simpler configurations of the same tools.</p>
      </div>
    </div>

    <div class="layer">
      <div class="layer-icon icon-blue"><i data-lucide="blocks"></i></div>
      <div class="layer-content">
        <h3>Composable Tools</h3>
        <p>Independent, event-sourced tools — Treasury, People, Agreements — unified by <a href="https://en.wikipedia.org/wiki/Resources,_events,_agents_(accounting_model)" style="color: var(--accent);">REA ontology</a>. Each tool solves one problem well. Together they compose into organizational infrastructure that makes economic relationships legible.</p>
      </div>
    </div>

    <div class="layer">
      <div class="layer-icon icon-orange"><i data-lucide="coins"></i></div>
      <div class="layer-content">
        <h3>Service Credits</h3>
        <p>A prepaid medium for information economy infrastructure. Four resource primitives — compute, transfer, long-term memory, short-term memory. The postage stamp of cooperative infrastructure: simple, fungible, useful.</p>
      </div>
    </div>
  </div>

  <div class="section" style="background: var(--bg-mid); padding: 3rem 2rem; margin: 2rem 0;">
    <h2 style="text-align: center; margin-bottom: 2rem;"><i data-lucide="coins" class="section-icon icon-orange"></i> Service Credits: The Postage Stamp Model</h2>
    <p style="text-align: center; max-width: 720px; margin: 0 auto 2.5rem; color: var(--text-muted);">A prepaid unit redeemable against four resource primitives. Simple. Fungible. Useful. No speculation, no staking — just infrastructure you can use.</p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
      <div class="credit-card">
        <div class="credit-icon"><i data-lucide="cpu"></i></div>
        <h3>Compute</h3>
        <p>CPU cycles, inference calls, function execution. The work the machine does on your behalf.</p>
        <div class="credit-example">1 credit ≈ 1,000 tokens processed</div>
      </div>

      <div class="credit-card">
        <div class="credit-icon icon-blue"><i data-lucide="activity"></i></div>
        <h3>Transfer</h3>
        <p>Bandwidth, API calls, network egress. The movement of information from one place to another.</p>
        <div class="credit-example">1 credit ≈ 100 MB transferred</div>
      </div>

      <div class="credit-card">
        <div class="credit-icon icon-orange"><i data-lucide="archive"></i></div>
        <h3>Long-Term Memory</h3>
        <p>Object storage, document archives, vector embeddings. Persistent state that survives across sessions.</p>
        <div class="credit-example">1 credit ≈ 1 GB stored per month</div>
      </div>

      <div class="credit-card">
        <div class="credit-icon"><i data-lucide="zap"></i></div>
        <h3>Short-Term Memory</h3>
        <p>Cache, session state, hot storage. Fast, ephemeral memory for active operations.</p>
        <div class="credit-example">1 credit ≈ 10 GB-hours</div>
      </div>
    </div>

    <div style="background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; padding: 1.5rem; max-width: 800px; margin: 0 auto;">
      <h3 style="margin-top: 0; display: flex; align-items: center; gap: 0.5rem;"><i data-lucide="stamp" style="width:20px;height:20px;stroke-width:1.5;color:var(--accent);"></i> Why "Postage Stamp"?</h3>
      <p style="margin-bottom: 1rem;">A postage stamp is prepaid, fungible, and redeemable against a specific service (mail delivery). Service credits work the same way:</p>
      <ul style="margin-left: 2.5rem;">
        <li><strong>Prepaid</strong> — you buy credits before consuming resources, avoiding billing complexity</li>
        <li><strong>Fungible</strong> — one credit is interchangeable with another; they compose freely across resource types</li>
        <li><strong>Redeemable</strong> — credits are spent when you use infrastructure, not held for speculation</li>
        <li><strong>Interoperable</strong> — multiple cooperatives can issue credits against the same shared grammar, enabling cross-organizational resource exchange</li>
      </ul>
      <p style="margin-top: 1rem; color: var(--text-muted); font-style: italic;">This design avoids securities classification (no expectation of profit), enables patronage-based distribution (allocations can be paid in credits), and makes cooperative infrastructure legible as a service layer.</p>
    </div>
  </div>

  <hr class="divider">

  <div class="section">
    <h2><i data-lucide="calculator" class="section-icon icon-orange"></i> See It Work</h2>
    <p>Adjust the contribution weights and see how patronage allocation distributes a cooperative's surplus among its members.</p>

    <div id="formula-demo" style="margin-top: 1.5rem;">
      <div style="display: flex; gap: 2rem; flex-wrap: wrap; margin-bottom: 1.5rem;">
        <div style="flex: 1; min-width: 280px;">
          <h3 style="font-size: 1rem; margin-bottom: 1rem;">Weights</h3>
          <div class="weight-sliders">
            <div class="slider-row">
              <label><i data-lucide="hammer" style="width:14px;height:14px;vertical-align:-2px;color:var(--accent);stroke-width:1.5;"></i> Labor</label>
              <input type="range" id="w-labor" min="0" max="100" value="40" oninput="updateFormula()">
              <span id="w-labor-val" class="weight-val">40%</span>
            </div>
            <div class="slider-row">
              <label><i data-lucide="trending-up" style="width:14px;height:14px;vertical-align:-2px;color:var(--accent-blue);stroke-width:1.5;"></i> Revenue</label>
              <input type="range" id="w-revenue" min="0" max="100" value="30" oninput="updateFormula()">
              <span id="w-revenue-val" class="weight-val">30%</span>
            </div>
            <div class="slider-row">
              <label><i data-lucide="landmark" style="width:14px;height:14px;vertical-align:-2px;color:var(--accent-blue);stroke-width:1.5;"></i> Cash</label>
              <input type="range" id="w-cash" min="0" max="100" value="20" oninput="updateFormula()">
              <span id="w-cash-val" class="weight-val">20%</span>
            </div>
            <div class="slider-row">
              <label><i data-lucide="users" style="width:14px;height:14px;vertical-align:-2px;color:var(--accent-orange);stroke-width:1.5;"></i> Community</label>
              <input type="range" id="w-community" min="0" max="100" value="10" oninput="updateFormula()">
              <span id="w-community-val" class="weight-val">10%</span>
            </div>
          </div>
          <p id="weight-total" style="font-size: 0.85rem; color: var(--text-muted); margin-top: 0.5rem;">Total: 100%</p>
        </div>

        <div style="flex: 1; min-width: 280px;">
          <h3 style="font-size: 1rem; margin-bottom: 1rem;">Surplus to Allocate</h3>
          <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
            <span style="font-size: 1.1rem; color: var(--text-muted);">$</span>
            <input type="number" id="surplus" value="50000" min="0" step="1000" oninput="updateFormula()" style="font-family: Georgia, serif; font-size: 1.1rem; padding: 0.4rem 0.6rem; border: 1px solid var(--border); border-radius: 6px; background: var(--card-bg); color: var(--text); width: 140px;">
          </div>
        </div>
      </div>

      <div style="overflow-x: auto;">
        <table id="allocation-table" style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
          <thead>
            <tr>
              <th style="text-align:left;padding:0.5rem 0.8rem;border-bottom:2px solid var(--border);font-weight:600;color:var(--text-muted);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.04em;">Member</th>
              <th style="text-align:right;padding:0.5rem 0.8rem;border-bottom:2px solid var(--border);font-weight:600;color:var(--text-muted);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.04em;">Labor Hrs</th>
              <th style="text-align:right;padding:0.5rem 0.8rem;border-bottom:2px solid var(--border);font-weight:600;color:var(--text-muted);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.04em;">Revenue</th>
              <th style="text-align:right;padding:0.5rem 0.8rem;border-bottom:2px solid var(--border);font-weight:600;color:var(--text-muted);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.04em;">Cash</th>
              <th style="text-align:right;padding:0.5rem 0.8rem;border-bottom:2px solid var(--border);font-weight:600;color:var(--text-muted);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.04em;">Community</th>
              <th style="text-align:right;padding:0.5rem 0.8rem;border-bottom:2px solid var(--border);font-weight:600;color:var(--accent);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.04em;">Share</th>
              <th style="text-align:right;padding:0.5rem 0.8rem;border-bottom:2px solid var(--border);font-weight:600;color:var(--accent);font-size:0.8rem;text-transform:uppercase;letter-spacing:0.04em;">Allocation</th>
            </tr>
          </thead>
          <tbody id="allocation-body"></tbody>
        </table>
      </div>

      <div id="allocation-bars" style="margin-top: 1.2rem;"></div>
    </div>
  </div>

  <style>
    .slider-row { display: flex; align-items: center; gap: 0.6rem; margin-bottom: 0.6rem; }
    .slider-row label { width: 100px; font-size: 0.88rem; color: var(--text); }
    .slider-row input[type="range"] { flex: 1; accent-color: var(--accent); }
    .weight-val { width: 36px; text-align: right; font-size: 0.85rem; color: var(--text-muted); font-variant-numeric: tabular-nums; }
    .bar-row { display: flex; align-items: center; gap: 0.6rem; margin-bottom: 0.4rem; }
    .bar-label { width: 70px; font-size: 0.82rem; color: var(--text-muted); text-align: right; }
    .bar-track { flex: 1; height: 20px; background: var(--bg-mid); border-radius: 4px; overflow: hidden; position: relative; }
    .bar-fill { height: 100%; border-radius: 4px; transition: width 0.3s ease; display: flex; align-items: center; justify-content: flex-end; padding-right: 6px; }
    .bar-amount { font-size: 0.75rem; color: white; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.3); }
  </style>

  <script>
    const members = [
      { name: "Alice", labor: 320, revenue: 18000, cash: 5000, community: 85 },
      { name: "Bob", labor: 240, revenue: 12000, cash: 8000, community: 60 },
      { name: "Carol", labor: 400, revenue: 8000, cash: 2000, community: 95 },
      { name: "David", labor: 180, revenue: 22000, cash: 3000, community: 40 },
    ];
    const barColors = ["var(--accent)", "var(--accent-blue)", "var(--accent-orange)", "#7c6b9e"];

    function updateFormula() {
      const wL = +document.getElementById('w-labor').value;
      const wR = +document.getElementById('w-revenue').value;
      const wC = +document.getElementById('w-cash').value;
      const wM = +document.getElementById('w-community').value;
      const surplus = +document.getElementById('surplus').value || 0;
      const total = wL + wR + wC + wM;

      document.getElementById('w-labor-val').textContent = wL + '%';
      document.getElementById('w-revenue-val').textContent = wR + '%';
      document.getElementById('w-cash-val').textContent = wC + '%';
      document.getElementById('w-community-val').textContent = wM + '%';

      const totalEl = document.getElementById('weight-total');
      totalEl.textContent = `Total: ${total}%`;
      totalEl.style.color = total === 100 ? 'var(--text-muted)' : 'var(--accent-orange)';

      // Normalize weights
      const nL = total > 0 ? wL / total : 0;
      const nR = total > 0 ? wR / total : 0;
      const nC = total > 0 ? wC / total : 0;
      const nM = total > 0 ? wM / total : 0;

      // Compute totals per category
      const totals = members.reduce((acc, m) => ({
        labor: acc.labor + m.labor,
        revenue: acc.revenue + m.revenue,
        cash: acc.cash + m.cash,
        community: acc.community + m.community
      }), { labor: 0, revenue: 0, cash: 0, community: 0 });

      // Compute weighted scores
      const scores = members.map(m => {
        const lPct = totals.labor > 0 ? m.labor / totals.labor : 0;
        const rPct = totals.revenue > 0 ? m.revenue / totals.revenue : 0;
        const cPct = totals.cash > 0 ? m.cash / totals.cash : 0;
        const mPct = totals.community > 0 ? m.community / totals.community : 0;
        return (lPct * nL) + (rPct * nR) + (cPct * nC) + (mPct * nM);
      });

      const scoreTotal = scores.reduce((a, b) => a + b, 0);
      const shares = scores.map(s => scoreTotal > 0 ? s / scoreTotal : 0);
      const allocations = shares.map(s => s * surplus);

      // Render table
      const tbody = document.getElementById('allocation-body');
      tbody.innerHTML = members.map((m, i) => `
        <tr>
          <td style="padding:0.5rem 0.8rem;border-bottom:1px solid var(--border);font-weight:600;">${m.name}</td>
          <td style="padding:0.5rem 0.8rem;border-bottom:1px solid var(--border);text-align:right;font-variant-numeric:tabular-nums;">${m.labor}</td>
          <td style="padding:0.5rem 0.8rem;border-bottom:1px solid var(--border);text-align:right;font-variant-numeric:tabular-nums;">$${m.revenue.toLocaleString()}</td>
          <td style="padding:0.5rem 0.8rem;border-bottom:1px solid var(--border);text-align:right;font-variant-numeric:tabular-nums;">$${m.cash.toLocaleString()}</td>
          <td style="padding:0.5rem 0.8rem;border-bottom:1px solid var(--border);text-align:right;font-variant-numeric:tabular-nums;">${m.community}</td>
          <td style="padding:0.5rem 0.8rem;border-bottom:1px solid var(--border);text-align:right;color:var(--accent);font-variant-numeric:tabular-nums;">${(shares[i]*100).toFixed(1)}%</td>
          <td style="padding:0.5rem 0.8rem;border-bottom:1px solid var(--border);text-align:right;font-weight:600;color:var(--accent);font-variant-numeric:tabular-nums;">$${allocations[i].toLocaleString(undefined, {minimumFractionDigits:0, maximumFractionDigits:0})}</td>
        </tr>
      `).join('');

      // Render bars
      const barsEl = document.getElementById('allocation-bars');
      barsEl.innerHTML = members.map((m, i) => `
        <div class="bar-row">
          <span class="bar-label">${m.name}</span>
          <div class="bar-track">
            <div class="bar-fill" style="width:${shares[i]*100}%;background:${barColors[i]};">
              ${allocations[i] >= 100 ? `<span class="bar-amount">$${allocations[i].toLocaleString(undefined, {maximumFractionDigits:0})}</span>` : ''}
            </div>
          </div>
        </div>
      `).join('');
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', updateFormula);
  </script>

  <hr class="divider">

  <div class="section">
    <h2><i data-lucide="compass" class="section-icon"></i> Explore</h2>
    <div class="cards">
      <a class="card" href="/matrix/">
        <div class="card-icon icon-blue"><i data-lucide="grid-3x3"></i></div>
        <h3>Economic Habitat Matrix</h3>
        <p>Interactive map of 49 organizational archetypes across seven ecological zones — from symbiotic to parasitic.</p>
      </a>
      <a class="card" href="/patronage/">
        <div class="card-icon"><i data-lucide="scale"></i></div>
        <h3>Patronage Accounting</h3>
        <p>How the patronage system works: capital accounts, contribution weights, allocation formulas, period close.</p>
      </a>
      <a class="card" href="/identity/">
        <div class="card-icon icon-blue"><i data-lucide="fingerprint"></i></div>
        <h3>Identity</h3>
        <p>Self-sovereign identity for cooperative networks. ENS-based membership and the foundation for peer-to-peer coordination.</p>
      </a>
      <a class="card" href="/thesis/">
        <div class="card-icon"><i data-lucide="book-open"></i></div>
        <h3>The Craft of Coordination</h3>
        <p>Compositional fluency, coordination primitives, and ecosystem compounding — the integrated thesis.</p>
      </a>
      <a class="card" href="/journal/">
        <div class="card-icon icon-orange"><i data-lucide="notebook-pen"></i></div>
        <h3>Build Journal</h3>
        <p>Sprint-by-sprint development notes. What was built, what was learned, what changed.</p>
      </a>
    </div>
  </div>

  <hr class="divider">

  <div class="section">
    <h2><i data-lucide="map-pin" class="section-icon"></i> Context</h2>
    <p>Habitat is built in public by a Colorado Limited Cooperative Association. We needed these tools ourselves — and designed them so any organization can use them.</p>
    <p>The system satisfies the most demanding compliance requirements (IRC 704(b), Subchapter K), which means every simpler use case is already covered. A freelancer needs Treasury. A startup needs Treasury + People. A cooperative needs all three configured for patronage-based allocation. Same primitives, different compositions.</p>
    <p class="muted">Open source. Built in public. The repo is the project.</p>
  </div>

  <footer>
    Where the Great Plains meet the Rocky Mountains, 5,430 feet<br>
    <a href="https://github.com/nou-techne/habitat">GitHub</a>
  </footer>
  <script>lucide.createIcons();</script>
</body>
</html>
